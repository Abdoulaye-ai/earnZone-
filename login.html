<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>EarnZone - Connexion & Inscription</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* Variables globales */
    :root {
      --primary: #00ffcc;
      --primary-dark: #00cca3;
      --secondary: #ff4d94;
      --accent: #9d4edd;
      --bg-dark: #0a1929;
      --bg-medium: #132f4c;
      --bg-light: #1e4a7b;
      --text-light: #ffffff;
      --text-dim: #b8d0ff;
      --card-bg: rgba(255, 255, 255, 0.08);
      --card-border: rgba(255, 255, 255, 0.12);
      --success: #4cff4c;
      --warning: #ffcc00;
      --danger: #ff4757;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    }

    /* Reset et styles de base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      min-height: 100vh;
      overflow-x: hidden;
      overflow-y: auto;
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Poppins', 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, var(--bg-dark), var(--bg-medium), var(--bg-light));
      background-attachment: fixed;
      color: var(--text-light);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px;
      min-height: 100vh;
    }

    /* Effets de particules */
    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      z-index: -1;
      top: 0;
      left: 0;
    }

    /* Conteneur principal */
    .auth-container {
      width: 100%;
      max-width: 450px;
      background: rgba(10, 25, 41, 0.85);
      backdrop-filter: blur(20px);
      border-radius: 30px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
      animation: containerSlide 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      margin-top: 20px;
    }

    @keyframes containerSlide {
      from {
        opacity: 0;
        transform: translateY(50px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Header de l'authentification */
    .auth-header {
      padding: 40px 40px 20px;
      text-align: center;
      position: relative;
    }

    .auth-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 2px;
    }

    .logo {
      font-size: 36px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
      display: inline-block;
    }

    .logo-subtitle {
      font-size: 14px;
      color: var(--text-dim);
      margin-bottom: 20px;
    }

    /* Boutons de sélection */
    .auth-tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 5px;
      margin: 20px 40px;
    }

    .auth-tab {
      flex: 1;
      padding: 15px;
      text-align: center;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-dim);
      background: transparent;
      border: none;
      cursor: pointer;
      border-radius: 12px;
      transition: var(--transition);
    }

    .auth-tab.active {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: black;
      box-shadow: 0 5px 15px rgba(0, 255, 204, 0.3);
    }

    /* Formulaires */
    .auth-forms {
      padding: 0 40px 40px;
    }

    .auth-form {
      display: none;
      animation: formFade 0.5s ease-out;
    }

    @keyframes formFade {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .auth-form.active {
      display: block;
    }

    .form-group {
      margin-bottom: 25px;
      position: relative;
    }

    .form-label {
      display: block;
      margin-bottom: 10px;
      font-size: 14px;
      color: var(--text-dim);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-input {
      width: 100%;
      padding: 18px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      color: var(--text-light);
      font-size: 16px;
      font-family: 'Poppins', sans-serif;
      transition: var(--transition);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0, 255, 204, 0.1);
      background: rgba(255, 255, 255, 0.08);
    }

    .form-input::placeholder {
      color: rgba(255, 255, 255, 0.3);
    }

    .input-icon {
      position: absolute;
      right: 20px;
      top: 55px;
      color: var(--text-dim);
      font-size: 18px;
    }

    /* Bouton de soumission */
    .submit-btn {
      width: 100%;
      padding: 20px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: black;
      font-size: 18px;
      font-weight: 700;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 10px;
      position: relative;
      overflow: hidden;
    }

    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0, 255, 204, 0.4);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .submit-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        to right,
        transparent 20%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 80%
      );
      transform: rotate(45deg);
      transition: all 0.6s;
    }

    .submit-btn:hover::after {
      left: 100%;
    }

    .submit-btn i {
      margin-right: 10px;
    }

    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Options supplémentaires */
    .auth-options {
      margin-top: 30px;
      text-align: center;
    }

    .remember-forgot {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .remember-me {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: var(--text-dim);
    }

    .checkbox {
      width: 18px;
      height: 18px;
      accent-color: var(--primary);
    }

    .forgot-password {
      color: var(--primary);
      font-size: 14px;
      text-decoration: none;
      transition: var(--transition);
    }

    .forgot-password:hover {
      text-decoration: underline;
    }

    .divider {
      display: flex;
      align-items: center;
      margin: 30px 0;
      color: var(--text-dim);
      font-size: 14px;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
    }

    .divider span {
      padding: 0 15px;
    }

    /* Connexion sociale */
    .social-login {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .social-btn {
      padding: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .social-btn:hover {
      transform: translateY(-3px);
      border-color: var(--primary);
      background: rgba(0, 255, 204, 0.1);
    }

    .social-btn.google {
      color: #4285F4;
    }

    .social-btn.facebook {
      color: #1877F2;
    }

    /* Lien entre les formulaires */
    .auth-switch {
      text-align: center;
      margin-top: 25px;
      font-size: 14px;
      color: var(--text-dim);
    }

    .auth-switch a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      margin-left: 5px;
      transition: var(--transition);
    }

    .auth-switch a:hover {
      text-decoration: underline;
    }

    /* Footer de l'authentification */
    .auth-footer {
      padding: 25px 40px;
      background: rgba(0, 0, 0, 0.2);
      text-align: center;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }

    .auth-footer p {
      font-size: 13px;
      color: var(--text-dim);
      line-height: 1.6;
    }

    .terms-link {
      color: var(--primary);
      text-decoration: none;
      transition: var(--transition);
    }

    .terms-link:hover {
      text-decoration: underline;
    }

    /* Message d'erreur/succès */
    .message {
      padding: 15px 20px;
      border-radius: 12px;
      margin-bottom: 25px;
      font-size: 14px;
      display: none;
      animation: messageSlide 0.3s ease-out;
      border-left: 4px solid;
    }

    @keyframes messageSlide {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message.success {
      background: rgba(76, 255, 76, 0.1);
      border-left-color: var(--success);
      color: var(--success);
    }

    .message.error {
      background: rgba(255, 71, 87, 0.1);
      border-left-color: var(--danger);
      color: var(--danger);
    }

    .message.warning {
      background: rgba(255, 204, 0, 0.1);
      border-left-color: var(--warning);
      color: var(--warning);
    }

    .message i {
      margin-right: 10px;
    }

    /* Animation de chargement */
    .loader {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Avantages de l'inscription */
    .benefits {
      background: linear-gradient(135deg, rgba(0, 255, 204, 0.1), rgba(157, 78, 221, 0.1));
      border-radius: 15px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .benefits h3 {
      font-size: 18px;
      color: var(--primary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .benefits-list {
      list-style: none;
    }

    .benefits-list li {
      padding: 8px 0;
      font-size: 14px;
      color: var(--text-dim);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .benefits-list li i {
      color: var(--success);
      font-size: 12px;
    }

    /* Mode invité */
    .guest-mode {
      text-align: center;
      margin-top: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      border: 1px dashed rgba(255, 255, 255, 0.1);
    }

    .guest-btn {
      background: transparent;
      border: 1px solid var(--primary);
      color: var(--primary);
      padding: 12px 25px;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 10px;
    }

    .guest-btn:hover {
      background: rgba(0, 255, 204, 0.1);
      transform: translateY(-3px);
    }

    /* Responsive */
    @media (max-width: 480px) {
      body {
        padding: 15px;
        align-items: flex-start;
        padding-top: 20px;
      }
      
      .auth-container {
        max-width: 100%;
        margin-top: 10px;
      }
      
      .auth-header,
      .auth-forms,
      .auth-footer {
        padding: 30px 25px;
      }
      
      .auth-tabs {
        margin: 20px 25px;
      }
      
      .social-login {
        grid-template-columns: 1fr;
      }
      
      .remember-forgot {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }
      
      .logo {
        font-size: 32px;
      }
    }

    @media (max-height: 700px) {
      body {
        align-items: flex-start;
        padding-top: 10px;
      }
      
      .auth-container {
        margin-top: 10px;
      }
    }
  </style>
</head>
<body>

  <!-- Effets de particules -->
  <div id="particles-js"></div>

  <!-- Conteneur d'authentification -->
  <div class="auth-container">
    
    <!-- Header -->
    <div class="auth-header">
      <div class="logo">
        <i class="fas fa-gem"></i>
        EarnZone
      </div>
      <p class="logo-subtitle">Commencez à gagner de l'argent dès aujourd'hui</p>
      
      <!-- Onglets Connexion/Inscription -->
      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="login">Connexion</button>
        <button class="auth-tab" data-tab="register">Inscription</button>
      </div>
    </div>

    <!-- Message de notification -->
    <div class="message" id="message"></div>

    <!-- Formulaires -->
    <div class="auth-forms">
      
      <!-- Formulaire de connexion -->
      <form class="auth-form active" id="loginForm">
        <div class="form-group">
          <label class="form-label" for="loginUsername">
            <i class="fas fa-envelope"></i>
            Email *
          </label>
          <input type="email" id="loginUsername" class="form-input" placeholder="votre@email.com" required>
          <div class="input-icon">
            <i class="fas fa-mail-bulk"></i>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="loginPassword">
            <i class="fas fa-lock"></i>
            Mot de passe *
          </label>
          <input type="password" id="loginPassword" class="form-input" placeholder="Votre mot de passe" required>
          <div class="input-icon">
            <i class="fas fa-key"></i>
          </div>
        </div>
        
        <div class="remember-forgot">
          <label class="remember-me">
            <input type="checkbox" class="checkbox" id="rememberMe">
            Se souvenir de moi
          </label>
          <a href="#" class="forgot-password" id="forgotPassword">Mot de passe oublié ?</a>
        </div>
        
        <button type="submit" class="submit-btn" id="loginBtn">
          <i class="fas fa-sign-in-alt"></i>
          Se connecter
        </button>
        
        <div class="divider">
          <span>Ou continuer avec</span>
        </div>
        
        <div class="social-login">
          <button type="button" class="social-btn google">
            <i class="fab fa-google"></i>
            Google
          </button>
          <button type="button" class="social-btn facebook">
            <i class="fab fa-facebook-f"></i>
            Facebook
          </button>
        </div>
        
        <div class="auth-switch">
          Pas encore de compte ?
          <a href="#" class="switch-to-register">S'inscrire</a>
        </div>
      </form>
      
      <!-- Formulaire d'inscription -->
      <form class="auth-form" id="registerForm">
        <div class="form-group">
          <label class="form-label" for="registerFullName">
            <i class="fas fa-user"></i>
            Nom complet *
          </label>
          <input type="text" id="registerFullName" class="form-input" placeholder="Ex: Moussa Diallo" required>
          <div class="input-icon">
            <i class="fas fa-user-circle"></i>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="registerEmail">
            <i class="fas fa-envelope"></i>
            Email *
          </label>
          <input type="email" id="registerEmail" class="form-input" placeholder="votre@email.com" required>
          <div class="input-icon">
            <i class="fas fa-at"></i>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="registerPassword">
            <i class="fas fa-lock"></i>
            Mot de passe *
          </label>
          <input type="password" id="registerPassword" class="form-input" placeholder="Minimum 6 caractères" required>
          <div class="input-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="registerConfirmPassword">
            <i class="fas fa-lock"></i>
            Confirmer le mot de passe *
          </label>
          <input type="password" id="registerConfirmPassword" class="form-input" placeholder="Répétez le mot de passe" required>
          <div class="input-icon">
            <i class="fas fa-check-double"></i>
          </div>
        </div>
        
        <div class="benefits">
          <h3><i class="fas fa-gift"></i> Avantages de l'inscription</h3>
          <ul class="benefits-list">
            <li><i class="fas fa-check-circle"></i> 200 FCFA offerts pour votre inscription</li>
            <li><i class="fas fa-check-circle"></i> 200 FCFA par vidéo regardée</li>
            <li><i class="fas fa-check-circle"></i> 500 FCFA par ami parrainé</li>
            <li><i class="fas fa-check-circle"></i> Retraits dès 1000 FCFA</li>
          </ul>
        </div>
        
        <button type="submit" class="submit-btn" id="registerBtn">
          <i class="fas fa-user-plus"></i>
          Créer mon compte
        </button>
        
        <div class="auth-switch">
          Déjà un compte ?
          <a href="#" class="switch-to-login">Se connecter</a>
        </div>
      </form>
      
      <!-- Mode invité -->
      <div class="guest-mode">
        <p>Vous voulez juste tester ?</p>
        <button class="guest-btn" id="guestBtn">
          <i class="fas fa-user-secret"></i>
          Continuer en tant qu'invité
        </button>
        <p style="font-size: 12px; margin-top: 10px; color: var(--text-dim);">
          Note: Les données seront sauvegardées localement uniquement
        </p>
      </div>
      
    </div>
    
    <!-- Footer -->
    <div class="auth-footer">
      <p>En vous inscrivant, vous acceptez nos 
        <a href="#" class="terms-link">Conditions d'utilisation</a> 
        et notre 
        <a href="#" class="terms-link">Politique de confidentialité</a>.
      </p>
      <p style="margin-top: 10px;">
        <i class="fas fa-shield-alt"></i>
        Vos données sont sécurisées et privées
      </p>
    </div>
    
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script>
    // Initialiser les particules
    particlesJS('particles-js', {
      particles: {
        number: { value: 60, density: { enable: true, value_area: 800 } },
        color: { value: ["#00ffcc", "#ff4d94", "#9d4edd"] },
        shape: { type: "circle" },
        opacity: { value: 0.3, random: true },
        size: { value: 2, random: true },
        line_linked: {
          enable: true,
          distance: 100,
          color: "#00ffcc",
          opacity: 0.1,
          width: 1
        },
        move: {
          enable: true,
          speed: 1,
          direction: "none",
          random: true,
          straight: false,
          out_mode: "out",
          bounce: false
        }
      },
      interactivity: {
        detect_on: "canvas",
        events: {
          onhover: { enable: true, mode: "repulse" },
          onclick: { enable: true, mode: "push" }
        }
      },
      retina_detect: true
    });

    // Variables globales
    let currentTab = 'login';
    let isLoading = false;

    // Initialiser le système de stockage
    function initStorage() {
      // Vérifier si le système de stockage existe
      if (!localStorage.getItem('earnzone_users_index')) {
        localStorage.setItem('earnzone_users_index', JSON.stringify([]));
      }
    }

    // Changer d'onglet
    function switchTab(tabId) {
      currentTab = tabId;
      
      // Mettre à jour les boutons d'onglet
      document.querySelectorAll('.auth-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabId) {
          tab.classList.add('active');
        }
      });
      
      // Mettre à jour les formulaires
      document.querySelectorAll('.auth-form').forEach(form => {
        form.classList.remove('active');
      });
      
      document.getElementById(`${tabId}Form`).classList.add('active');
      
      // Cacher les messages
      hideMessage();
    }

    // Liens de switch
    document.querySelector('.switch-to-register').addEventListener('click', function(e) {
      e.preventDefault();
      switchTab('register');
    });
    
    document.querySelector('.switch-to-login').addEventListener('click', function(e) {
      e.preventDefault();
      switchTab('login');
    });

    // Afficher un message
    function showMessage(text, type) {
      const messageDiv = document.getElementById('message');
      messageDiv.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
        ${text}
      `;
      messageDiv.className = `message ${type}`;
      messageDiv.style.display = 'block';
      
      // Faire défiler pour voir le message
      setTimeout(() => {
        messageDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }

    // Cacher le message
    function hideMessage() {
      document.getElementById('message').style.display = 'none';
    }

    // Simuler le chargement
    function setLoading(button, loading) {
      isLoading = loading;
      
      if (loading) {
        const originalHTML = button.innerHTML;
        button.setAttribute('data-original', originalHTML);
        button.innerHTML = `
          <span class="loader"></span>
          Traitement en cours...
        `;
        button.disabled = true;
      } else {
        const originalHTML = button.getAttribute('data-original');
        if (originalHTML) {
          button.innerHTML = originalHTML;
        }
        button.disabled = false;
      }
    }

    // Fonction pour trouver un utilisateur
    function findUserByEmail(email) {
      const usersIndex = JSON.parse(localStorage.getItem('earnzone_users_index')) || [];
      
      for (const userId of usersIndex) {
        const userDataStr = localStorage.getItem(`earnzone_user_${userId}`);
        if (userDataStr) {
          const userData = JSON.parse(userDataStr);
          if (userData.email && userData.email.toLowerCase() === email.toLowerCase()) {
            return {
              id: userId,
              data: userData
            };
          }
        }
      }
      return null;
    }

    // Fonction pour vérifier si un email existe
    function emailExists(email) {
      return findUserByEmail(email) !== null;
    }

    // Formulaire d'inscription
    document.getElementById('registerForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const fullName = document.getElementById('registerFullName').value.trim();
      const email = document.getElementById('registerEmail').value.trim().toLowerCase();
      const password = document.getElementById('registerPassword').value.trim();
      const confirmPassword = document.getElementById('registerConfirmPassword').value.trim();
      const registerBtn = document.getElementById('registerBtn');
      
      // Validation
      if (!fullName || fullName.length < 2) {
        showMessage('Le nom complet doit contenir au moins 2 caractères', 'error');
        return;
      }
      
      if (!email) {
        showMessage('L\'email est obligatoire', 'error');
        return;
      }
      
      // Validation email
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        showMessage('Veuillez entrer une adresse email valide', 'error');
        return;
      }
      
      if (!password || password.length < 6) {
        showMessage('Le mot de passe doit contenir au moins 6 caractères', 'error');
        return;
      }
      
      if (password !== confirmPassword) {
        showMessage('Les mots de passe ne correspondent pas', 'error');
        return;
      }
      
      // Vérifier si l'email existe déjà
      if (emailExists(email)) {
        showMessage('Cette adresse email est déjà utilisée. Veuillez vous connecter.', 'error');
        return;
      }
      
      setLoading(registerBtn, true);
      
      // Simuler un délai réseau
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      try {
        // Générer un ID unique
        const userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        
        // Créer l'objet utilisateur
        const userData = {
          id: userId,
          fullName: fullName,
          email: email,
          password: password,
          balance: 200, // Bonus d'inscription
          totalEarned: 200,
          totalWithdrawn: 0,
          videosWatched: 0,
          tiktokVideosWatched: 0,
          referrals: 0,
          level: 1,
          registrationDate: new Date().toISOString(),
          lastLogin: new Date().toISOString(),
          isActive: true
        };
        
        // Sauvegarder l'utilisateur
        localStorage.setItem(`earnzone_user_${userId}`, JSON.stringify(userData));
        
        // Mettre à jour l'index des utilisateurs
        const usersIndex = JSON.parse(localStorage.getItem('earnzone_users_index')) || [];
        usersIndex.push(userId);
        localStorage.setItem('earnzone_users_index', JSON.stringify(usersIndex));
        
        // Sauvegarder la correspondance email -> userId
        localStorage.setItem(`earnzone_email_${email}`, userId);
        
        // Définir comme utilisateur courant
        localStorage.setItem('earnzone_current_user', userId);
        
        // Si "Se souvenir de moi" est coché
        const rememberMe = document.getElementById('rememberMe').checked;
        if (rememberMe) {
          localStorage.setItem('earnzone_remembered_user', userId);
        }
        
        showMessage(`Compte créé avec succès ! Bienvenue ${fullName}`, 'success');
        
        // Redirection après 1.5 secondes
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500);
        
      } catch (error) {
        console.error('Erreur lors de l\'inscription:', error);
        showMessage('Une erreur est survenue. Veuillez réessayer.', 'error');
        setLoading(registerBtn, false);
      }
    });

    // Formulaire de connexion
    document.getElementById('loginForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const email = document.getElementById('loginUsername').value.trim().toLowerCase();
      const password = document.getElementById('loginPassword').value.trim();
      const loginBtn = document.getElementById('loginBtn');
      
      // Validation
      if (!email) {
        showMessage('Veuillez entrer votre email', 'error');
        return;
      }
      
      if (!password) {
        showMessage('Veuillez entrer votre mot de passe', 'error');
        return;
      }
      
      setLoading(loginBtn, true);
      
      // Simuler un délai réseau
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      try {
        // Chercher l'utilisateur par email
        const user = findUserByEmail(email);
        
        if (!user) {
          showMessage('Email ou mot de passe incorrect', 'error');
          setLoading(loginBtn, false);
          return;
        }
        
        // Vérifier le mot de passe
        if (user.data.password !== password) {
          showMessage('Email ou mot de passe incorrect', 'error');
          setLoading(loginBtn, false);
          return;
        }
        
        // Connexion réussie
        localStorage.setItem('earnzone_current_user', user.id);
        
        // Mettre à jour la dernière connexion
        user.data.lastLogin = new Date().toISOString();
        localStorage.setItem(`earnzone_user_${user.id}`, JSON.stringify(user.data));
        
        // Si "Se souvenir de moi" est coché
        const rememberMe = document.getElementById('rememberMe').checked;
        if (rememberMe) {
          localStorage.setItem('earnzone_remembered_user', user.id);
        } else {
          localStorage.removeItem('earnzone_remembered_user');
        }
        
        showMessage(`Connexion réussie ! Bienvenue ${user.data.fullName || user.data.email}`, 'success');
        
        // Redirection après 1.5 secondes
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500);
        
      } catch (error) {
        console.error('Erreur lors de la connexion:', error);
        showMessage('Une erreur est survenue. Veuillez réessayer.', 'error');
        setLoading(loginBtn, false);
      }
    });

    // Mode invité
    document.getElementById('guestBtn').addEventListener('click', async function() {
      const guestBtn = document.getElementById('guestBtn');
      
      if (confirm('Mode invité : Vos données seront sauvegardées localement seulement. Continuer ?')) {
        setLoading(guestBtn, true);
        
        // Simuler un délai
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        try {
          // Générer un ID utilisateur invité
          const guestId = 'guest_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          const guestName = 'Invité' + Math.floor(Math.random() * 1000);
          const guestEmail = `guest_${guestId}@earnzone.com`;
          
          const guestData = {
            id: guestId,
            fullName: guestName,
            email: guestEmail,
            password: 'guest123',
            balance: 0,
            totalEarned: 0,
            totalWithdrawn: 0,
            videosWatched: 0,
            tiktokVideosWatched: 0,
            referrals: 0,
            level: 1,
            registrationDate: new Date().toISOString(),
            lastLogin: new Date().toISOString(),
            isGuest: true,
            isActive: true
          };
          
          // Sauvegarder l'utilisateur invité
          localStorage.setItem(`earnzone_user_${guestId}`, JSON.stringify(guestData));
          
          // Mettre à jour l'index
          const usersIndex = JSON.parse(localStorage.getItem('earnzone_users_index')) || [];
          usersIndex.push(guestId);
          localStorage.setItem('earnzone_users_index', JSON.stringify(usersIndex));
          
          // Définir comme utilisateur courant
          localStorage.setItem('earnzone_current_user', guestId);
          
          showMessage(`Mode invité activé ! Bienvenue ${guestName}`, 'success');
          
          // Redirection
          setTimeout(() => {
            window.location.href = 'index.html';
          }, 1500);
          
        } catch (error) {
          console.error('Erreur mode invité:', error);
          showMessage('Erreur lors de l\'activation du mode invité', 'error');
          setLoading(guestBtn, false);
        }
      }
    });

    // Connexion sociale (simulée)
    document.querySelectorAll('.social-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const platform = this.classList.contains('google') ? 'Google' : 'Facebook';
        showMessage(`Connexion avec ${platform} n'est pas disponible en démo. Utilisez l'inscription normale.`, 'warning');
      });
    });

    // Mot de passe oublié
    document.getElementById('forgotPassword').addEventListener('click', function(e) {
      e.preventDefault();
      showMessage('Pour réinitialiser votre mot de passe, contactez le support à support@earnzone.com', 'info');
    });

    // Initialiser les onglets
    document.querySelectorAll('.auth-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        const tabId = this.getAttribute('data-tab');
        switchTab(tabId);
      });
    });

    // Vérifier si déjà connecté
    window.onload = function() {
      initStorage();
      
      const currentUserId = localStorage.getItem('earnzone_current_user');
      const rememberedUserId = localStorage.getItem('earnzone_remembered_user');
      
      // Si un utilisateur est déjà connecté ou mémorisé
      if (currentUserId || rememberedUserId) {
        const userId = currentUserId || rememberedUserId;
        const userDataStr = localStorage.getItem(`earnzone_user_${userId}`);
        
        if (userDataStr) {
          const userData = JSON.parse(userDataStr);
          
          // Demander confirmation pour rester connecté
          if (confirm(`Bonjour ${userData.fullName || userData.email} ! Voulez-vous rester connecté ?`)) {
            if (!currentUserId && rememberedUserId) {
              localStorage.setItem('earnzone_current_user', rememberedUserId);
            }
            window.location.href = 'index.html';
            return;
          } else {
            // Déconnexion
            localStorage.removeItem('earnzone_current_user');
            localStorage.removeItem('earnzone_remembered_user');
            showMessage('Vous avez été déconnecté.', 'info');
          }
        }
      }
      
      // Focus sur le premier champ
      document.getElementById('loginUsername').focus();
      
      // Charger l'email mémorisé si existant
      const rememberedEmail = localStorage.getItem('earnzone_remembered_email');
      if (rememberedEmail) {
        document.getElementById('loginUsername').value = rememberedEmail;
      }
    };
  </script>

</body>
</html>